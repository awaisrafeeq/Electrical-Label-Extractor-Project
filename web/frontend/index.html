<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electrical Label Extractor</title>
    <link rel="stylesheet" href="/static/css/style.css?v=5.0">
</head>
<body>
    <div class="container">
        <header>
            <h1>üèóÔ∏è Electrical Label Extractor</h1>
            <p>AI-powered extraction of equipment labels from electrical diagrams</p>
        </header>

        <!-- Step 1: Upload -->
        <div id="upload-section" class="section">
            <h2>Step 1: Upload PDF</h2>
            <div id="drop-zone" class="drop-zone">
                <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p>Drag & Drop PDF Here</p>
                <p class="or">or</p>
                <button id="browse-btn" class="btn btn-primary">Browse Files</button>
                <input type="file" id="file-input" accept=".pdf" hidden>
            </div>
            <div id="file-info" class="file-info" style="display: none;">
                <p><strong>File:</strong> <span id="filename"></span></p>
                <p><strong>Pages:</strong> <span id="page-count"></span></p>
                <p><strong>Job ID:</strong> <span id="job-id"></span></p>
            </div>
        </div>

        <!-- Step 2: Configuration -->
        <div id="config-section" class="section" style="display: none;">
            <h2>Step 2: Configuration</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="vision-provider">Vision AI Provider:</label>
                    <select id="vision-provider">
                        <option value="openai">OpenAI (GPT-4o)</option>
                        <option value="anthropic">Anthropic (Claude)</option>
                    </select>
                </div>
                <div class="config-item">
                    <label for="quality">Processing Quality:</label>
                    <select id="quality">
                        <option value="150">Fast (DPI: 150)</option>
                        <option value="200" selected>Balanced (DPI: 200)</option>
                        <option value="300">High Quality (DPI: 300)</option>
                    </select>
                </div>
            </div>
            <button id="start-btn" class="btn btn-success btn-large">Start Extraction</button>
        </div>

        <!-- Step 3: Processing -->
        <div id="processing-section" class="section" style="display: none;">
            <h2>Step 3: Processing...</h2>

            <!-- Current Activity Status -->
            <div class="activity-status">
                <span id="activity-icon">üîÑ</span>
                <span id="activity-text">Initializing...</span>
            </div>

            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>
                <p id="progress-text">Initializing...</p>
            </div>

            <div class="processing-stats">
                <div class="stat">
                    <span class="stat-value" id="current-page">-</span>
                    <span class="stat-label">Current Page</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="labels-count">0</span>
                    <span class="stat-label">Labels Found</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="processing-speed">-</span>
                    <span class="stat-label">Pages/Min</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="time-remaining">-</span>
                    <span class="stat-label">Time Remaining</span>
                </div>
            </div>

            <div class="processing-actions">
                <button id="cancel-btn" class="btn btn-danger">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                    Stop Processing
                </button>
            </div>
        </div>

        <!-- Step 4: Review Labels -->
        <div id="results-section" class="section" style="display: none;">
            <h2>Step 4: Review & Edit Labels</h2>
            <div class="results-header">
                <div class="results-stats">
                    <span><strong><span id="total-labels">0</span></strong> labels extracted</span>
                </div>
                <div class="results-actions">
                    <button id="download-excel-btn" class="btn btn-success">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                        </svg>
                        Download Excel
                    </button>
                </div>
            </div>

            <div class="table-container">
                <table id="labels-table" class="labels-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Image</th>
                            <th>Equipment Type</th>
                            <th>Device Tag</th>
                            <th>Fed From</th>
                            <th>Primary From</th>
                            <th>Specs</th>
                            <th>Spare</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="labels-tbody">
                        <!-- Labels will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- New Job Button -->
        <div id="new-job-section" class="section" style="display: none;">
            <button id="new-job-btn" class="btn btn-primary btn-large">Process Another PDF</button>
        </div>

    </div>

    <!-- Image Modal -->
    <div id="image-modal" class="image-modal">
        <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
        <img id="modal-image" class="image-modal-content" src="" alt="">
        <div id="modal-caption" class="image-modal-caption"></div>
    </div>

    <script src="/static/js/app.js?v=5.0"></script>
</body>
</html>
